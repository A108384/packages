name       : bitwarden-cli
version    : 2024.8.2
release    : 16
source     :
    - https://github.com/bitwarden/clients/archive/refs/tags/cli-v2024.8.2.tar.gz : 210b40f54de79f4ac3d20419fc58b0e7ff6cebe5f3c107c68d0d2e6b8b073cd2
homepage   : https://bitwarden.com/help/cli/
license    : GPL-3.0-only
component  : security
summary    : CLI client for Bitwarden
description: CLI client for Bitwarden, a secure and free password manager for all of your devices
networking : yes
strip      : no
debug      : no
builddeps  :
    - git
    - nodejs-18
environment: |
    export npm_config_build_from_source=true

    # npm is called recursively and we need that to use nodejs-18
    export PATH=/usr/lib64/nodejs-18/bin:$PATH
setup      : |
    npm-18 ci
build      : |
    cd apps/cli

    npm-18 run dist:oss:lin

    node-18 ./build/bw.js completion --shell zsh > _bw
install    : |
    cd apps/cli

    install -Dm00755 dist/oss/linux/bw $installdir/usr/bin/bw
    install -Dm00644 _bw $installdir/usr/share/zsh/site-functions/_bw
