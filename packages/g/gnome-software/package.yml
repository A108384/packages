name       : gnome-software
version    : '45.3'
release    : 1
source     :
    - https://download.gnome.org/sources/gnome-software/45/gnome-software-45.3.tar.xz : d6b9245b22237da7bd1739dd28c23cc8f3835f99fa10c1037d9dd7635335251c
homepage   : https://apps.gnome.org/Software/
license    : GPL-2.0-or-later
component  : desktop.gnome
summary    : GNOME Software allows users to easily find, discover and install apps. (UNSUPPORTED)
description: |
    Warning: this package is unsupported and experimental.

    GNOME Software allows users to easily find, discover and install apps. It also keeps their OS, apps and devices up to date without them having to think about it, and gives them confidence that their system is up to date. It supports popular distributions, subject to those distributions maintaining their own distro-specific integration code.
builddeps  :
    - pkgconfig(appstream)
    - pkgconfig(flatpak)
    - pkgconfig(fwupd)
    - pkgconfig(gsettings-desktop-schemas)
    - pkgconfig(gtk4)
    - pkgconfig(json-glib-1.0)
    - pkgconfig(libadwaita-1)
    - pkgconfig(libsoup-3.0)
    - pkgconfig(packagekit-glib2)
    - pkgconfig(xmlb)
    - gtk-doc
setup      : |
    # Reenable me for GNOME 46!
    #patch -p1 -i $pkgfiles/0001-gs-appstream-Check-against-kernel-relation-types.patch

    %patch -p1 -i $pkgfiles/0001-port-to-appstream1.patch
    %patch -p1 -i $pkgfiles/0001-packagekit-Hardcode-some-solus-thingies.patch
    %meson_configure \
        -Dpackagekit_autoremove=true \
        -Dmalcontent=false \
        -Dtests=false
build      : |
    %ninja_build
install    : |
    %ninja_install

    install -Dm00644 $pkgfiles/org.gnome.software.gschema.override $installdir/usr/share/glib-2.0/schemas/org.gnome.software.gschema.override
