name       : libvpx
version    : 1.13.0
release    : 17
source     :
    - https://github.com/webmproject/libvpx/archive/refs/tags/v1.13.0.tar.gz : cb2a393c9c1fae7aba76b950bb0ad393ba105409fe1a147ccd61b0aaa1501066
homepage   : http://www.webmproject.org/
license    : MIT
component  : multimedia.codecs
summary    : Reference implementation of the VP8 & VP9 codec
description: |
    Reference implementation of the VP8 & VP9 codec
emul32     : yes
optimize   : lto
builddeps  :
    - yasm
setup      : |
    %patch -p1 -i $pkgfiles/encode_api_test.patch
    %patch -p1 -i $pkgfiles/vp8-security.patch

    if [[ ! -z "${EMUL32BUILD}" ]]; then
        TARGET_CC=x86-linux-gcc
    else
        TARGET_CC=x86_64-linux-gcc
    fi

    ./configure \
        --disable-static \
        --disable-unit-tests \
        --enable-shared \
        --enable-vp9-highbitdepth \
        --enable-vp9-postproc \
        --enable-vp9-temporal-denoising \
        --libdir=%libdir% \
        --prefix=/usr \
        --target=$TARGET_CC
build      : |
    %make
install    : |
    %make_install
